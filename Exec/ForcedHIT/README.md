# Forced Homogeneous Isotropic Turbulence

The linear forcing scheme is activated by setting `USE_LINEARFORCING = TRUE`
at compile time in the `GNUmakefile`. The scheme is based on the linear
forcing scheme of [Bassenne et al. (2016) Phys. Fluids](https://doi.org/10.1063/1.4944629)
that is in turn based off of
[Carroll and Blanquart (2013) Phys. Fluids](https://doi.org/10.1063/1.4826315),
[Lundgren (2003) CTR Ann. Res. Briefs](https://apps.dtic.mil/dtic/tr/fulltext/u2/p014826.pdf),
and [Rosales and Meneveau (2005) Phys. Fluids](https://doi.org/10.1063/1.2047568).

## Generating the initial conditions

The initial velocity field is generated by `gen_hit_ic.py` and stored in
files with the prefix `hit_ic_k0_N.dat`, where `k0` is the most
energetic wave number and `N` is the size of the grid. The initial
condition for a grid of size N^3 is generated as follows:

1. velocity fluctuations generated on a 512^3 grid in wavenumber space
2. Coefficients associated to wavenumbers that cannot be represented on the desired grid are set to 0 (sharp wavenumber cutoff)
3. inverse Fourier transform of the velocity fluctuations (512^3 grid)
4. velocity fluctuations resampled on the desired grid (N^3)

This script accepts the following options
```
./gen_hit_ic.py --help
usage: gen_hit_ic.py [-h] [-k0 K0] [-N N] [-s SEED] [-p]

Generate the velocity fluctuations for the HIT IC

optional arguments:
  -h, --help            show this help message and exit
  -k0 K0                Wave number containing highest energy
  -N N                  Resolution
  -s SEED, --seed SEED  Random number generator seed
  -p, --plot            Save a plot of the x-velocit1y
```

Generating an initial condition file is as easy as:
```{bash}
./gen_hit_ic.py -N 16
```

Likewise, the initial scalar field (if desired) is generated by `gen_hit_scal_ic.py`
and stored in files with the prefix `hit_scal_ic_k0_N.dat`.

## Running the code

PeleLM reads the file generated by the above script. The IC file name
resolution is specified by the user. The IC data is interpolated to
the Pele grid nodes and the user can (optionally) normalize the input
data using the `uin_norm` parameter.
